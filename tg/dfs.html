<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>–ì—Ä–∞—Ñ—ã ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –¥–µ—Ä–µ–≤—å—è, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É - –ê–ª–≥–æ—Ä–∏—Ç–º–∏–∫–∞</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="../pandoc.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfjBggQFxAS4ilBAAACgElEQVRIx52VS0iUYRSGn/8fzbxMIYoRKSZKi2wGwo2FxRQZIlGbaGUF0b52LWbTLlx0W7VyEZiBWkE5mraRRrJFRUwolQw6zQTeuoiU423eFuk0M//nhJ7dd+Z7n/8932HOscgIgU0lR/Cxn3LKgGlijDJIkAgJiywhZMujVo0qrsyIa1St8shWFnmp/IooW0TkV6mMYuRVQCv6X6woIK+QQ16vkPP2M/WZICHVpyGEvCb5vE7olH6bEV6l1R4w3RpQkYoVNJcSWHsLIUt+rTpvLOuSELqihAmwKr8sgZBHE2aX5UKoRmNmDxPyCBtoodLU1m5yaADC9Jr7XkkLoCqNmPAx1eqqnqhAqEHfzB5GVGXTQLUJ/5xZznGcOuAtQbOHahpsfOQ5f5mng8McZAdnsVigkyUTIA8fGjZ561OpuiRJY6oR2qU35iKGbSqc4GU6qObYmstmYIrH5iIq0JIT+17lupU8BVUsVKsvJgdLtgnbxXZOJ091HAU+0W+0YCnGnvRUlCa+42OdbRHiA3CSbtyZ+q85RDMBfcxxjZKUf5uPO4wwzGsaMwFR1JZe1Jx8uuB4mBtC6LJzXLTZDLKYihziM+fJzfjQGfYC/XxMTy8yaDNEOLWBDznAIcdT7aMRiPI0PR1myGacnn+Zd7ygiUIHwEUjuUAnsdR0D+M20E7k7/knt5ki39guN9uAEPeIr6citIPrOsxQiC9hveIuLylkkgXyKUsR/2CAB8yyEzdhJiliN3aCmzwCCwSl3FfzDL9wYZFAuClJAcSZJoELALFKAWVYvVxkdm3NbDRUs0TqUM021jeU15s2w9YXSxKy9dWWRGx6uVpOyObW+x/B+LEV0hF3cAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNi0wOFQxNjoyMzoxNiswMjowMLEfSBUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDYtMDhUMTY6MjM6MTYrMDI6MDDAQvCpAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />
  
  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
     (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
     m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
     (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
  
     ym(53961409, "init", {
          clickmap:true,
          trackLinks:true,
          accurateTrackBounce:true,
          webvisor:true
     });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53961409" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->
  
  <script>
  // index page width
  document.addEventListener("DOMContentLoaded", function(event) {
    document.getElementsByClassName('contents')[0].parentElement.style.width = "860px";
    document.getElementsByTagName('h1')[0].style.marginRight = "40px";
  });
  </script>
</head>
<body>
<div id='header'>
    <a href='https://algorithmica.org/ru/'><div id='logo'>–ê–ª–≥–æ—Ä–∏—Ç–º–∏–∫–∞</div></a>
    <div id='links'>
        <!--<a href='https://algorithmica.org/ru/'>–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>-->
        <a href='https://github.com/algorithmica-org/articles/edit/master/src/ru/dfs.md'>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <!--<a href='https://github.com/algorithmica-org/articles/commits/master/src/ru/dfs.md'>–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</a>-->
    </div>
</div>
<h1 id="–≥—Ä–∞—Ñ—ã-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-–¥–µ—Ä–µ–≤—å—è-—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–∏-–ø–æ–∏—Å–∫-–≤-–≥–ª—É–±–∏–Ω—É">–ì—Ä–∞—Ñ—ã ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –¥–µ—Ä–µ–≤—å—è, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É</h1>
<h2 id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è">–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h2>
<p>–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</p>
<p>–ì—Ä–∞—Ñ–æ–º <span class="math inline">\(G\)</span> –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤ <span class="math inline">\(G = (V, E\)</span>, –≥–¥–µ <span class="math inline">\(V(G)\)</span> ‚Äî –Ω–µ–ø—É—Å—Ç–æ–µ –∫–æ–Ω–µ—á–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–∞–∑—ã–≤–∞–µ–º—ã—Ö <strong>–≤–µ—Ä—à–∏–Ω–∞–º–∏</strong> –≥—Ä–∞—Ñ–∞, –∞ <span class="math inline">\(E\)</span> ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ <span class="math inline">\(V\)</span> (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö), –Ω–∞–∑—ã–≤–∞–µ–º—ã—Ö <strong>—Ä–µ–±—Ä–∞–º–∏</strong> –≥—Ä–∞—Ñ–∞. <span class="math inline">\(E = \{(u , v)\ | u, v \in V\}\)</span> ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞ <span class="math inline">\(G\)</span>, —Å–æ—Å—Ç–æ—è—â–µ–µ –∏–∑ –ø–∞—Ä –≤–µ—Ä—à–∏–Ω <span class="math inline">\((u, v)\)</span>. –†–µ–±—Ä–æ <span class="math inline">\((u, v)\)</span> —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(u\)</span> –∏ <span class="math inline">\(v\)</span>.</p>
<p>–ü—Ä–æ—Å—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</p>
<p>–ì—Ä–∞—Ñ - —ç—Ç–æ –Ω–∞–±–æ—Ä –≤–µ—Ä—à–∏–Ω (—Ç–æ—á–µ–∫) –∏ —Å–æ–µ–¥–∏–Ω—è—é—â–∏—Ö –∏—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤ (—Ä—ë–±–µ—Ä).</p>
<figure>
<img src="http://i.imgur.com/vE0aVrE.jpg" alt="–ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∞" /><figcaption>–ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∞</figcaption>
</figure>
<p>–î–≤–µ –≤–µ—Ä—à–∏–Ω—ã, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —Ä–µ–±—Ä–æ–º, –Ω–∞–∑—ã–≤–∞—é—Ç —Å–º–µ–∂–Ω—ã–º–∏ –≤–µ—Ä—à–∏–Ω–∞–º–∏. –û–±—ã—á–Ω–æ –≤ –∑–∞–¥–∞—á–∞—Ö <span class="math inline">\(N\)</span> - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω, –∞ <span class="math inline">\(M\)</span> - —Ä–µ–±–µ—Ä. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä, –∏—Å—Ö–æ–¥—è—â–µ–µ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã –Ω–∞–∑—ã–≤–∞—é—Ç —Å—Ç–µ–ø–µ–Ω—å—é –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(d(v)\)</span>. –î–ª—è –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(a\)</span> —Ä–µ–±—Ä–æ <span class="math inline">\((a, b)\)</span> –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω—ã–º –µ–π. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ –≤–µ—Ä—à–∏–Ω–µ 8 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω–æ —Ç–æ–ª—å–∫–æ —Ä–µ–±—Ä–æ (4, 8), –∞ –≤–µ—Ä—à–∏–Ω–µ 10 —Ä–µ–±—Ä–∞ (2, 10) –∏ (5, 10).</p>
<h3 id="—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–ù–∞–∑–æ–≤–∏—Ç–µ —Å—Ç–µ–ø–µ–Ω—å 1-–æ–π –∏ 6-–æ–π –≤–µ—Ä—à–∏–Ω—ã –∏ –∫–∞–∫–∏–µ —Ä–µ–±—Ä–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏–º.</p>
<figure>
<img src="http://gaskley.narod.ru/Discr/more_2/10.gif" alt="1" /><figcaption>1</figcaption>
</figure>
<p>–ï—Å–ª–∏ –∫–∞–∫–∏–µ-—Ç–æ –¥–≤–µ –≤–µ—Ä—à–∏–Ω—ã —Å–æ–µ–¥–∏–Ω–µ–Ω—ã –±–æ–ª–µ–µ, —á–µ–º –æ–¥–Ω–∏–º —Ä–µ–±—Ä–æ–º, —Ç–æ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –≥—Ä–∞—Ñ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∞—Ç–Ω—ã–µ —Ä–µ–±—Ä–∞. –ï—Å–ª–∏ —Ä–µ–±—Ä–æ —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤–µ—Ä—à–∏–Ω—É —Å–∞–º—É —Å —Å–æ–±–æ–π, —Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–±—Ä–æ –Ω–∞–∑—ã–≤–∞—é—Ç –ø–µ—Ç–ª–µ–π.</p>
<p><strong>–ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ</strong> –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ç–µ–ª—å –∏ –∫—Ä–∞—Ç–Ω—ã—Ö —Ä–µ–±–µ—Ä. –ï—Å–ª–∏ –Ω–µ —Å–∫–∞–∑–∞–Ω–æ –Ω–∏—á–µ–≥–æ –ø—Ä–æ –Ω–∞–ª–∏—á–∏–µ –ø–µ—Ç–µ–ª—å –∏ –∫—Ä–∞—Ç–Ω—ã—Ö —Ä–µ–±–µ—Ä, –º—ã –±—É–¥–µ–º –≤—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –≥—Ä–∞—Ñ –ø—Ä–æ—Å—Ç–æ–π.</p>
<h3 id="—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-1">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–°–∫–æ–ª—å–∫–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä—ë–±–µ—Ä –≤ –ø—Ä–æ—Å—Ç–æ–º –≥—Ä–∞—Ñ–µ –≤ <span class="math inline">\(N\)</span> –≤–µ—Ä—à–∏–Ω–∞–º–∏?</p>
<figure>
<img src="http://rain.ifmo.ru/cat/data/theory/unsorted/matroids-2004/graph.gif" alt="2" /><figcaption>2</figcaption>
</figure>
<h3 id="—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-2">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–ù–∞–π–¥–∏—Ç–µ —Ü–∏–∫–ª —Ä–∞–∑–º–µ—Ä–∞ 4 –∏ –ø–µ—Ç–ª—é –≤ —ç—Ç–æ–º –Ω–µ–ø—Ä–æ—Å—Ç–æ–º –≥—Ä–∞—Ñ–µ.</p>
<p>–¢–∞–∫–∂–µ —á–∞—Å—Ç–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç <strong>–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ—ã</strong> ‚Äî —ç—Ç–æ –≥—Ä–∞—Ñ—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–±—Ä–∞ –∏–º–µ—é—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∞ –∏–Ω–∞—á–µ –≥—Ä–∞—Ñ ‚Äì –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π.</p>
<pre><code></code></pre>
<h2 id="—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–≥—Ä–∞—Ñ–∞-–≤-–ø—Ä–æ–≥—Ä–∞–º–º–µ">–•—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ</h2>
<p>–ß–∞—â–µ –≤—Å–µ–≥–æ –≤ –∑–∞–¥–∞—á–∞—Ö –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞ - —ç—Ç–æ —á–∏—Å–ª–∞ –æ—Ç <span class="math inline">\(0\)</span> –¥–æ <span class="math inline">\(N-1\)</span>, —á—Ç–æ–±—ã —É–¥–æ–±–Ω–æ –±—ã–ª–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∏–º –∫–∞–∫ –∫ –∏–Ω–¥–µ–∫—Å–∞–º –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞—Å—Å–∏–≤–∞—Ö.</p>
<p>–¢–∞–∫–∂–µ —á–∞—â–µ –≤—Å–µ–≥–æ –≤–∞–º –¥–∞—é—Ç —Å—á–∏—Ç–∞—Ç—å –≥—Ä–∞—Ñ –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä—ë–±–µ—Ä –≤ –Ω–µ–º (–Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞, –∫–æ–Ω–µ—á–Ω–æ). –ö–∞–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ —Å—á–∏—Ç–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞—Ñ? –ï—Å—Ç—å 3 —Å–ø–æ—Å–æ–±–∞.</p>
<p>–î–ª—è –≥—Ä–∞—Ñ–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è:</p>
<ol type="1">
<li><strong>–ú–∞—Ç—Ä–∏—Ü–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏.</strong> –î–∞–≤–∞–π—Ç–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–≤—É–º–µ—Ä–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É <span class="math inline">\(A_{nn}\)</span>, –≥–¥–µ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ G –≤–µ—Ä–Ω–æ, —á—Ç–æ –µ—Å–ª–∏ <span class="math inline">\(A_{ij}\)</span> = 1, —Ç–æ –¥–≤–µ –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(i\)</span> –∏ <span class="math inline">\(j\)</span> —è–≤–ª—è—é—Ç—Å—è —Å–º–µ–∂–Ω—ã–º–∏, –∏–Ω–∞—á–µ –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(i\)</span> –∏ <span class="math inline">\(j\)</span> —Å–º–µ–∂–Ω—ã–º–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è.</li>
</ol>
<figure>
<img src="http://www.compendium.su/informatics/ege_1/ege_1.files/image026.jpg" alt="–ì—Ä–∞—Ñ G –∏ –ú–∞—Ç—Ä–∏—Ü–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏" /><figcaption>–ì—Ä–∞—Ñ G –∏ –ú–∞—Ç—Ä–∏—Ü–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏</figcaption>
</figure>
<p>–ú—ã —Ö—Ä–∞–Ω–∏–º –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ <span class="math inline">\(N\)</span> –≤–µ—Ä—à–∏–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –µ—Å—Ç—å –ª–∏ —Ä–µ–±—Ä–æ –≤ –¥—Ä—É–≥–∏–µ –≤–µ—Ä—à–∏–Ω—ã, —Ç–æ –µ—Å—Ç—å —Å—É–º–º–∞—Ä–Ω–æ –º—ã —Ö—Ä–∞–Ω–∏–º <span class="math inline">\(N^2\)</span> —è—á–µ–µ–∫, –∞ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –ø–æ –ø–∞–º—è—Ç–∏ - <span class="math inline">\(O(N^2)\)</span>.</p>
<ol start="2" type="1">
<li><strong>–°–ø–∏—Å–æ–∫ —Å–º–µ–∂–Ω–æ—Å—Ç–∏.</strong> –î–∞–≤–∞–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ <span class="math inline">\(N\)</span> –≤–µ—Ä—à–∏–Ω —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Å–º–µ–∂–Ω—ã–µ —Å –Ω–µ–π, –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ª—é–±–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä vector –≤ —Å++.</li>
</ol>
<pre><code>// –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ
vector&lt;vector&lt;int&gt; &gt; g(n);
for (int i = 0; i &lt; n; ++i){
    for (int j = 0;j &lt; n;++j){
        cin &gt;&gt; a;
        if (a) g[i].push_back(j);
    }
}
// —Å–ø–∏—Å–æ–∫ –ø–æ —Å–ø–∏—Å–∫—É —Ä–µ–±–µ—Ä
cin &gt;&gt; n &gt;&gt; m;
vector&lt;vector&lt;int&gt; &gt; g(n);
for (int i = 0; i &lt; m; ++i){
  cin &gt;&gt; v1 &gt;&gt; v2;
  g[v1].push_back(v2);
  g[v2].push_back(v1);
}</code></pre>
<p>–ó–¥–µ—Å—å –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –ø–æ –ø–∞–º—è—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è - <span class="math inline">\(O(N + M)\)</span>, —Ç–∞–∫ –∫–∞–∫ –º—ã —Ö—Ä–∞–Ω–∏–º –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã, –∫—É–¥–∞ –µ—Å—Ç—å —Ä–µ–±—Ä–∞, —Ç–æ –µ—Å—Ç—å <span class="math inline">\(2 M\)</span> —Ä–µ–±–µ—Ä, –∞ —Ç–∞–∫–∂–µ —Å—É–º–º–∞—Ä–Ω–æ <span class="math inline">\(N\)</span> –≤–µ–∫—Ç–æ—Ä–æ–≤.</p>
<p>–ü–ª–æ—Ç–Ω—ã–µ –≥—Ä–∞—Ñ—ã, –∏–º–µ—é—â–∏–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä —Å–ª–µ–¥—É–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–∞—Ç—Ä–∏—Ü—ã —Å–º–µ–∂–Ω–æ—Å—Ç–∏, –∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ—ã, –∏–º–µ—é—â–∏–µ –º–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä, –æ–ø—Ç–∏–º–∞–ª—å–Ω–µ–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–ø–∏—Å–∫–∞.</p>
<ol start="3" type="1">
<li><strong>–°–ø–∏—Å–æ–∫ —Ä—ë–±–µ—Ä</strong>. –ò–Ω–æ–≥–¥–∞ –≥—Ä–∞—Ñ —è–≤–Ω–æ –≤–æ–æ–±—â–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –∞ —Ö–≤–∞—Ç–∞–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ —Ä–µ–±–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –¥–∞—é—Ç –Ω–∞ –≤—Ö–æ–¥.</li>
</ol>
<p>–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤—Å–µ —ç—Ç–∏ —Å–ø–æ—Å–æ–±—ã –æ–±–æ—â–∞—é—Ç—Å—è –Ω–∞ —Å–ª—É—á–∞–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ - –ø—Ä–∏ —ç—Ç–æ–º –º–∞—Ç—Ä–∏—Ü–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–æ—Ä–∏–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π: –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–±—Ä–æ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(i\)</span> –≤ –≤–µ—Ä—à–∏–Ω—É <span class="math inline">\(j\)</span>, —Ç–æ —Å–¥–µ–ª–∞–µ–º <span class="math inline">\(A_{ij} = 1\)</span>, –∞ <span class="math inline">\(A_{ji} = 0\)</span>, –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–µ–±—Ä–∞ —Ç–æ–∂–µ. –ê –≤ —Å–ø–∏—Å–∫–µ —Å–º–µ–∂–Ω–æ—Å—Ç–∏ –≤ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ —Ä–µ–±—Ä–∞ <span class="math inline">\((u, v)\)</span> –±—É–¥–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ <span class="math inline">\(v\)</span> –≤ —Å–ø–∏—Å–æ–∫ —Å–æ—Å–µ–¥–µ–π <span class="math inline">\(u\)</span>, –Ω–æ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç.</p>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–î–ª—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ç–µ–º—ã —Å–æ–≤–µ—Ç—É—é —Ä–µ—à–∏—Ç—å –ø–µ—Ä–≤—ã–µ 2 –∑–∞–¥–∞—á–∏.</p>
<h2 id="–¥–µ—Ä–µ–≤—å—è">–î–µ—Ä–µ–≤—å—è</h2>
<p>–î–µ—Ä–µ–≤–æ - —ç—Ç–æ <strong>—Å–≤—è–∑–Ω—ã–π –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ –±–µ–∑ —Ü–∏–∫–ª–æ–≤</strong>.</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Tree_graph.svg/162px-Tree_graph.svg.png" alt="–ü—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞" /><figcaption>–ü—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞</figcaption>
</figure>
<p>–°–≤–æ–π—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤–∞:</p>
<ol type="1">
<li>–£ –¥–µ—Ä–µ–≤–∞ —Å —Ö–æ—Ç—è –±—ã 2 –≤–µ—Ä—à–∏–Ω–∞–º–∏ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å <strong>–≤–∏—Å—è—á–∞—è –≤–µ—Ä—à–∏–Ω–∞</strong> - –≤–µ—Ä—à–∏–Ω–∞ —Å—Ç–µ–ø–µ–Ω–∏ 1.</li>
</ol>
<p>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–∞—á–∞—Ç—å –∏–∑ –ª—é–±–æ–π –≤–µ—Ä—à–∏–Ω—ã –∏–¥—Ç–∏ –ø–æ –Ω–µ–ø–æ—Å–µ—â–µ–Ω–Ω—ã–º —Ä–∞–Ω–µ–µ –≤–µ—Ä—à–∏–Ω–∞–º, —Ç–æ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º—ã –ø—Ä–µ–∫—Ä–∞—Ç–∏–º —ç—Ç–æ –¥–µ–ª–∞—Ç—å, –≤–µ–¥—å –≥—Ä–∞—Ñ –∫–æ–Ω–µ—á–Ω—ã–π. –ü—Ä–∏ —ç—Ç–æ–º –µ—Å–ª–∏ –∏–∑ —ç—Ç–æ–π –≤–µ—Ä—à–∏–Ω—ã –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–±–µ—Ä –≤ –Ω–µ–ø–æ—Å–µ—â–µ–Ω–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã - –≤–µ–¥—å —Ç–æ–≥–¥–∞ –ø—Ä–µ–∫—Ä–∞—â–∞—Ç—å —Ä–∞–Ω–æ, –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–±–µ—Ä –≤ –ø–æ—Å–µ—â–µ–Ω–Ω—ã–µ —Ä–µ–±—Ä–∞ (–ø–æ–º–∏–º–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π) - –≤–µ–¥—å —Ç–æ–≥–¥–∞ –µ—Å—Ç—å —Ü–∏–∫–ª. –ê –∑–Ω–∞—á–∏—Ç, –µ—Å—Ç—å —Ä–µ–±—Ä–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—à–∏–Ω—É, –∑–Ω–∞—á–∏—Ç —Å—Ç–µ–ø–µ–Ω—å —Ä–∞–≤–Ω–∞ 1.</p>
<ol start="2" type="1">
<li>–£ –¥–µ—Ä–µ–≤–∞ —Å —Ö–æ—Ç—è –±—ã 2 –≤–µ—Ä—à–∏–Ω–∞–º–∏ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –¥–≤–µ –≤–∏—Å—è—á–∏–µ –≤–µ—Ä—à–∏–Ω—ã.</li>
</ol>
<p>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—á–∞—Ç—å –∏–∑ –≤–∏—Å—è—á–µ–π –≤–µ—Ä—à–∏–Ω—ã, —Ç–æ –º—ã —É—Ç–∫–Ω–µ–º—Å—è –≤ –¥—Ä—É–≥—É—é –≤–∏—Å—è—á—É—é –≤–µ—Ä—à–∏–Ω—É.</p>
<ol start="3" type="1">
<li>–£ –¥–µ—Ä–µ–≤–∞ —Å <span class="math inline">\(N\)</span> –≤–µ—Ä—à–∏–Ω–∞–º–∏ –≤—Å–µ–≥–¥–∞ —Ä–æ–≤–Ω–æ <span class="math inline">\(N-1\)</span> —Ä–µ–±—Ä–æ.</li>
</ol>
<p>–î–∞–≤–∞–π—Ç–µ –æ—Ç—Ä–µ–∑–∞—Ç—å –æ—Ç –¥–µ—Ä–µ–≤–∞ –µ–≥–æ –≤–∏—Å—è—á–∏–µ –≤–µ—Ä—à–∏–Ω—ã - –ø—Ä–∏ —ç—Ç–æ–º —á–∏—Å–ª–æ –≤–µ—Ä—à–∏–Ω —É–º–µ–Ω—å—à–∏—Ç—Å—è –Ω–∞ –æ–¥–∏–Ω, —á–∏—Å–ª–æ —Ä–µ–±–µ—Ä —Ç–æ–∂–µ —É–º–µ–Ω—å—à–∏—Ç—Å—è –Ω–∞ –æ–¥–∏–Ω, –∞ –≥—Ä–∞—Ñ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ–º. –†–∞–∑ –≥—Ä–∞—Ñ –æ—Å—Ç–∞–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ–º, —É –Ω–µ–≥–æ –≤—Å–µ –≤—Ä–µ–º—è –±—É–¥–µ—Ç –≤–∏—Å—è—á–∞—è –≤–µ—Ä—à–∏–Ω–∞, –ø–æ–∫–∞ <span class="math inline">\(N &gt; 1\)</span>. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≤–µ—Ä—à–∏–Ω–∞ –∏ –Ω–æ–ª—å —Ä–µ–±–µ—Ä. –†–∞–∑ –º—ã –æ—Ç—Ä–µ–∑–∞–ª–∏ —Å—Ç–æ–ª—å–∫–æ –∂–µ –≤–µ—Ä—à–∏–Ω, —Å–∫–æ–ª—å–∫–æ —Ä–µ–±–µ—Ä, –∏ –ø–æ–ª—É—á–∏–ª–∏ 1 –≤–µ—Ä—à–∏–Ω—É –∏ 0 —Ä–µ–±–µ—Ä, –∑–Ω–∞—á–∏—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤–µ—Ä—à–∏–Ω –±—ã–ª–æ —Ä–æ–≤–Ω–æ –Ω–∞ –æ–¥–Ω—É –±–æ–ª—å—à–µ.</p>
<ol start="4" type="1">
<li>–ú–µ–∂–¥—É –ª—é–±—ã–º–∏ –¥–≤—É–º—è –≤–µ—Ä—à–∏–Ω–∞–º–∏ –≤ –¥–µ—Ä–µ–≤–µ –µ—Å—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å.</li>
</ol>
<p>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –∏—Ö –¥–≤–∞, —Ç–æ –≤ –≥—Ä–∞—Ñ–µ –µ—Å—Ç—å —Ü–∏–∫–ª. –ë—ã—Ç—å –Ω–æ–ª—å –∏—Ö –Ω–µ –º–æ–∂–µ—Ç - –≤–µ–¥—å –≥—Ä–∞—Ñ —Å–≤—è–∑–Ω—ã–π.</p>
<ol start="5" type="1">
<li>–î–µ—Ä–µ–≤–æ - —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ —á–∏—Å–ª—É —Ä—ë–±–µ—Ä —Å–≤—è–∑–Ω—ã–π –≥—Ä–∞—Ñ –Ω–∞ <span class="math inline">\(N\)</span> –≤–µ—Ä—à–∏–Ω–∞—Ö.</li>
</ol>
<p>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–Ω—ã–π –≥—Ä–∞—Ñ, –≤ –∫–æ—Ç–æ—Ä–æ–º –º–µ–Ω—å—à–µ, —á–µ–º <span class="math inline">\(N-1\)</span> —Ä–µ–±—Ä–æ, —Ç–æ –¥–∞–≤–∞–π—Ç–µ —É–±–µ—Ä–µ–º –∏–∑ –µ–≥–æ —Ü–∏–∫–ª–∞ —Ä–µ–±—Ä–æ. –ì—Ä–∞—Ñ –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞–µ—Ç—Å—è —Å–≤—è–∑–Ω—ã–º, –∞ —á–∏—Å–ª–æ —Ä–µ–±–µ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è. –î–∞–≤–∞–π—Ç–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å —ç—Ç–æ, –ø–æ–∫–∞ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç —Ü–∏–∫–ª–æ–≤ –≤ –≥—Ä–∞—Ñ–µ –Ω–µ –±—É–¥–µ—Ç, –∞ –∑–Ω–∞—á–∏—Ç –æ—Å—Ç–∞–ª–æ—Å—å –¥–µ—Ä–µ–≤–æ. –ù–æ –º—ã —É–∂–µ –¥–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –≤ –¥–µ—Ä–µ–≤–µ <span class="math inline">\(N-1\)</span> —Ä–µ–±—Ä–æ, —ç—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ, –≤–µ–¥—å —É –Ω–∞—Å —Å–Ω–∞—á–∞–ª–∞ –±—ã–ª–æ –º–µ–Ω—å—à–µ —Ä–µ–±–µ—Ä, –∞ –º—ã –µ—â–µ –∏ —É–¥–∞–ª–∏–ª–∏ —Å–∫–æ–ª—å–∫–æ-—Ç–æ.</p>
<h2 id="dfs-–∞–ª–≥–æ—Ä–∏—Ç–º-–æ–±—Ö–æ–¥–∞-–≥—Ä–∞—Ñ–∞-–≤-–≥–ª—É–±–∏–Ω—É">DFS (–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ö–æ–¥–∞ –≥—Ä–∞—Ñ–∞ –≤ –≥–ª—É–±–∏–Ω—É)</h2>
<p>–û–±—Ö–æ–¥ –≤ –≥–ª—É–±–∏–Ω—É ‚Äî –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ö–æ–¥–∞ –≥—Ä–∞—Ñ–∞ –ø–æ —Ä–µ–±—Ä–∞–º. –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç ‚Äî —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –≤–µ—Ä—à–∏–Ω—ã –¥–æ—Å—Ç–∏–∂–∏–º—ã –∏–∑ –¥–∞–Ω–Ω–æ–π.</p>
<p>–ü—Ä–∏ –æ–±—Ö–æ–¥–µ –≥—Ä–∞—Ñ–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤ used, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω–∏–º 1, –µ—Å–ª–∏ –≤–µ—Ä—à–∏–Ω–∞ –±—ã–ª–∞ –ø–æ—Å–µ—â–µ–Ω–∞ –∏–ª–∏ 0 –∏–Ω–∞—á–µ. –í –Ω–∞—á–∞–ª–µ –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å, –∑–∞—Ç–µ–º –º—ã –≤—ã–±–∏—Ä–∞–µ–º –æ–¥–Ω—É –≤–µ—Ä—à–∏–Ω—É, –ø–æ–º–µ—á–∞–µ–º –µ–µ –ø–æ—Å–µ—â–µ–Ω–Ω–æ–π –∏ –∑–∞–ø—É—Å–∫–∞–µ–º—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏–∑ –≤—Å–µ—Ö –µ–µ —Å–æ—Å–µ–¥–µ–π, —Ç–æ–≥–¥–∞ –º—ã –ø–æ—Å–µ—Ç–∏–º –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—Ç–∏–∂–∏–º—ã –∏–∑ –¥–∞–Ω–Ω–æ–π, –µ—Å–ª–∏ –∂–µ –æ—Å—Ç–∞–ª–∏—Å—å –≤–µ—Ä—à–∏–Ω—ã —Å used = 0 –∑–Ω–∞—á–∏—Ç –æ–Ω–∏ –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã.</p>
<p>–ö—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: https://visualgo.net/en/dfsbfs</p>
<pre><code>void dfs (int v) {
  used[v] = 1;
  for (auto to : g[v]) {
      if (!used[to]) {
          dfs(to);
      }
  }
}</code></pre>
<p>–î–∞–≤–∞–π—Ç–µ –æ—Ü–µ–Ω–∏–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –¢–∞–∫ –∫–∞–∫ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤–µ—Ä—à–∏–Ω–∞ –µ—â–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å, —Ç–æ –≤—Å–µ–≥–æ –º—ã –ø—Ä–æ–π–¥–µ—Ç –∫–∞–∂–¥—É—é –≤–µ—Ä—à–∏–Ω—É 1 —Ä–∞–∑, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –∏ —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –¥–≤—É–º—è –≤–µ—Ä—à–∏–Ω–∞–º–∏, –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∫–æ–Ω–µ—Ü, —Ç–æ –µ—Å—Ç—å –º—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∂–¥–æ–µ —Ä–µ–±—Ä–æ –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞, —Å—É–º–º–∞—Ä–Ω–æ –ø–æ–ª—É—á–∞–µ–º –æ—Ü–µ–Ω–∫—É <span class="math inline">\(O(N + M)\)</span>.</p>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-1">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–ó–∞–¥–∞—á–∏ 3-5 –≤ –∫–æ–Ω—Ç–µ—Å—Ç–µ.</p>
<h2 id="–ø–æ–∏—Å–∫-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç-—Å–≤—è–∑–Ω–æ—Å—Ç–∏-–≥—Ä–∞—Ñ–∞">–ü–æ–∏—Å–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –≥—Ä–∞—Ñ–∞</h2>
<p>–ü—É—Ç–µ–º –≤ –≥—Ä–∞—Ñ–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä—à–∏–Ω <span class="math inline">\(v_i \in ùëâ\)</span>, <span class="math inline">\(i = 1...k\)</span> —Ç–∞–∫–∏—Ö, —á—Ç–æ –¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã –≤ –ø—É—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω—ã —Ä–µ–±—Ä–æ–º, <span class="math inline">\(k\)</span> - –¥–ª–∏–Ω–∞ –ø—É—Ç–∏. –ì—Ä–∞—Ñ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–≤—è–∑–Ω—ã–º, –µ—Å–ª–∏ –¥–ª—è –ª—é–±—ã—Ö –¥–≤—É—Ö –µ–≥–æ –≤–µ—Ä—à–∏–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø—É—Ç—å –º–µ–∂–¥—É –Ω–∏–º–∏. –ì—Ä–∞—Ñ –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è —Å–≤—è–∑–Ω—ã–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ (–≤–æ–∑–º–æ–∂–Ω–æ –æ–¥–Ω–æ), –º–µ–∂–¥—É –∫–æ—Ç–æ—Ä—ã–º–∏ —Ä—ë–±–µ—Ä –Ω–µ—Ç, –æ–Ω–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–≤—è–∑–Ω–æ—Å—Ç–∏.</p>
<p>–ü–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É dfs –±—É–¥–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å —Ç—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É —Å–≤—è–∑–Ω–æ—Å—Ç–∏, –∏–∑ –≤–µ—Ä—à–∏–Ω—ã –∫–æ—Ç–æ—Ä–æ–π, –æ–Ω –±—ã–ª –≤—ã–∑–≤–∞–Ω. –ü–æ—ç—Ç–æ–º—É –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∏–∑ –ª—é–±–æ–π –Ω–µ–ø–æ—Å–µ—â–µ–Ω–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã –∏ —Ç–æ–≥–¥–∞ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ—Å–µ—Ç–∏–º –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã, –∞ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏ –Ω–∞–π–¥–µ–º –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–≤—è–∑–Ω–æ—Å—Ç–∏.</p>
<h1 id="–≥—Ä–∞—Ñ-—Å-—Ç—Ä–µ–º—è-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏-—Å–≤—è–∑–Ω–æ—Å—Ç–∏"><img src="http://lib.vvsu.ru/books/Bakalavr01/obj.files/image726.gif" alt="–ì—Ä–∞—Ñ —Å —Ç—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–≤—è–∑–Ω–æ—Å—Ç–∏" /></h1>
<pre><code>for (int i = 0; i &lt; n; ++i){
    if (!used[i]) {
        amount++;
        dfs(i);
    }
}</code></pre>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-2">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>–ù–∞ –¥–∞–Ω–Ω—É—é —Ç–µ–º—É –∑–∞–¥–∞—á–∏ 6 –∏ 10 –≤ –∫–æ–Ω—Ç–µ—Å—Ç–µ.</p>
<h2 id="–æ—Å—Ç–æ–≤–Ω–æ–µ-–¥–µ—Ä–µ–≤–æ">–û—Å—Ç–æ–≤–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</h2>
<p>–û—Å—Ç–æ–≤–∞–Ω—ã–º –¥–µ—Ä–µ–≤–æ–º –≤ —Å–≤—è–∑–Ω–æ–º –≥—Ä–∞—Ñ–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª—é–±–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ–º –Ω–∞ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω–∞—Ö. –¢–æ –µ—Å—Ç—å –ª—é–±–æ–π —Å–ø–æ—Å–æ–± –≤—ã–∫–∏–Ω—É—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–±–µ—Ä —Ç–∞–∫, —á—Ç–æ–±—ã –æ—Å—Ç–∞–ª–æ—Å—å –¥–µ—Ä–µ–≤–æ –Ω–∞ N –≤–µ—Ä—à–∏–Ω–∞—Ö –∏ N-1 —Ä–µ–±—Ä–æ –≤—ã–¥–µ–ª—è–µ—Ç –≤ –≥—Ä–∞—Ñ–µ –æ—Å—Ç–æ–≤–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.</p>
<p>–û–±—Ö–æ–¥ –≥—Ä–∞—Ñ–∞ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ –æ—Å—Ç–æ–≤–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ - <strong>–µ—Å–ª–∏ –≤—ã–¥–µ–ª–∏—Ç—å –∫–∞–∂–¥–æ–µ —Ä–µ–±—Ä–æ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –º—ã –ø—Ä–æ—à–ª–∏ –≤ –æ–±—Ö–æ–¥–µ, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –æ—Å—Ç–æ–≤–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</strong>. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –º—ã –æ–±–æ–π–¥–µ–º –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã, –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–π–¥–µ–º –≤ –≤–µ—Ä—à–∏–Ω—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —É–∂–µ –±—ã–ª–∏, –ø–æ—ç—Ç–æ–º—É —Ü–∏–∫–ª–æ–≤ —Ç–∞–º –Ω–µ –±—É–¥–µ—Ç. –¢–∞–∫ —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–¥–∞ –ø–æ –ª—é–±–æ–º—É —Ä–µ–±—Ä—É –¥–æ–±–∞–≤–ª—è—Ç—å –µ–≥–æ –≤ –æ—Ç–≤–µ—Ç.</p>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-3">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>7 –∑–∞–¥–∞—á–∞ –≤ –∫–æ–Ω—Ç–µ—Å—Ç–µ –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ—Å—Ç–æ–≤–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –≤ –≥—Ä–∞—Ñ–µ.</p>
<h2 id="—Ä–∞—Å–∫—Ä–∞—Å–∫–∞-–≥—Ä–∞—Ñ–∞-–≤-–¥–≤–∞-—Ü–≤–µ—Ç–∞">–†–∞—Å–∫—Ä–∞—Å–∫–∞ –≥—Ä–∞—Ñ–∞ –≤ –¥–≤–∞ —Ü–≤–µ—Ç–∞</h2>
<p>–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞—Å–∫—Ä–∞—Å–∫–æ–π –≥—Ä–∞—Ñ–∞ –≤ –¥–≤–∞ —Ü–≤–µ—Ç–∞ –Ω–∞–∑—ã–≤–µ—Ç—Å—è —Ç–∞–∫–∞—è —Ä–∞—Å–∫—Ä–∞—Å–∫–∞, —á—Ç–æ –Ω–∏–∫–∞–∫–æ–µ —Ä–µ–±—Ä–æ –Ω–µ —Å–æ–µ–¥–∏–Ω—è–µ—Ç –¥–≤–µ –≤–µ—Ä—à–∏–Ω—ã –æ–¥–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞. –ì—Ä–∞—Ñ—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Ç–∞–∫ —Ä–∞—Å–∫—Ä–∞—Å–∏—Ç—å, –Ω–∞–∑—ã–≤–∞—é—Ç –µ—â–µ <strong>–¥–≤—É–¥–æ–ª—å–Ω—ã–º–∏</strong>.</p>
<p>–° –ø–æ–º–æ—â—å—é –æ–±—Ö–æ–¥–∞ –≥—Ä–∞—Ñ–∞ –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥—Ä–∞—Ñ –Ω–∞ –¥–≤—É–¥–æ–ª—å–Ω–æ—Å—Ç—å –∏ –¥–∞–∂–µ –≤—ã–≤–µ—Å—Ç–∏ —Ü–≤–µ—Ç –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –∫–∞–∂–¥—É—é.</p>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-4">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>8 –∑–∞–¥–∞—á–∞ –≤ –∫–æ–Ω—Ç–µ—Å—Ç–µ –Ω–∞ —Ä–∞—Å–∫—Ä–∞—Å–∫—É –≥—Ä–∞—Ñ–∞ –≤ –¥–≤–∞ —Ü–≤–µ—Ç–∞</p>
<h2 id="–ø–æ–∏—Å–∫-—Ü–∏–∫–ª–æ–≤-–≤-–≥—Ä–∞—Ñ–µ">–ü–æ–∏—Å–∫ —Ü–∏–∫–ª–æ–≤ –≤ –≥—Ä–∞—Ñ–µ</h2>
<p>–¶–∏–∫–ª–æ–º –≤ –≥—Ä–∞—Ñ–µ <span class="math inline">\(G\)</span> –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–Ω—É–ª–µ–≤–æ–π –ø—É—Ç—å, –≤–µ–¥—É—â–∏–π –∏–∑ –≤–µ—Ä—à–∏–Ω—ã <span class="math inline">\(v\)</span> –≤ —Å–∞–º—É —Å–µ–±—è. –ì—Ä–∞—Ñ –Ω–∞–∑—ã–≤–∞—é—Ç –∞—Ü–∏–∫–ª–∏—á–Ω—ã–º, –µ—Å–ª–∏ –≤ –Ω–µ–º –Ω–µ—Ç —Ü–∏–∫–ª–æ–≤.</p>
<p>–í –æ–±—ã—á–Ω–æ–º dfs –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–≤–∞ —Ü–≤–µ—Ç–∞ (1 - –≤–µ—Ä—à–∏–Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∞, 0 - –Ω–µ –ø–æ—Å–µ—â–µ–Ω–∞), –µ—Å–ª–∏ –∂–µ –Ω–∞–º –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ —Ü–∏–∫–ª, —Ç–æ –¥–∞–≤–∞–π—Ç–µ —Ö—Ä–∞–Ω–∏—Ç—å 3 —Ü–≤–µ—Ç–∞:</p>
<ul>
<li>0 - –≤–µ—Ä—à–∏–Ω–∞ –Ω–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–∞</li>
<li>1 - –º—ã –≤—Ö–æ–¥–∏–ª–∏ DFS-–æ–º –≤ —ç—Ç—É –≤–µ—Ä—à–∏–Ω—É, –Ω–æ –µ—â–µ –Ω–µ –≤—ã—à–ª–∏ (–∞ –∑–Ω–∞—á–∏—Ç –∏–∑ –Ω–µ–µ –µ—Å—Ç—å –ø—É—Ç—å –¥–æ —Ç–µ–∫—É—â–µ–π),</li>
<li>2 - –º—ã –≤—Ö–æ–¥–∏–ª–∏ DFS-–æ–º –≤ —ç—Ç—É –≤–µ—Ä—à–∏–Ω—É</li>
</ul>
<p>–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ü–∏–∫–ª –±—É–¥–µ—Ç —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –≤–æ–π—Ç–∏ –≤ –≤–µ—Ä—à–∏–Ω—É —Å —Ü–≤–µ—Ç–æ–º 1.</p>
<pre><code>void dfs (int v) {
    used[v] = 1;
    for (size_t i=0; i &lt; g[v].size(); ++i) {
        int to = g[v][i];
        if (used[to] == 0){
            p[to] = v;
            dfs (to);
        }
        else if (used[to] == 1 &amp;&amp; to != p[v]) {
            cycle = true;
        }
    }
    used[v] = 2;
}</code></pre>
<p>–í –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≥—Ä–∞—Ñ–µ —Ç–∞–∫–∂–µ –Ω–∞–¥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –º—ã –∏–¥–µ–º –≤ –ø—Ä–µ–¥–∫–∞ - —ç—Ç–æ —Ü–∏–∫–ª–æ–º –≤—Å–µ-—Ç–∞–∫–∏ –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è, –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç prev, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—à–∏–Ω—É –≤ dfs, –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–¥—Ç–∏ –≤ –Ω–µ—ë.</p>
<h3 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ-–∑–∞–¥–∞–Ω–∏–µ-5">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
<p>9 –∑–∞–¥–∞—á–∞ –≤ –∫–æ–Ω—Ç–µ—Å—Ç–µ –Ω–∞ –ø–æ–∏—Å–∫ —Ü–∏–∫–ª–∞ –≤ –≥—Ä–∞—Ñ–µ.</p>
<p>#–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ–Ω—Ç–µ—Å—Ç</p>
<p>https://informatics.msk.ru/mod/statements/view3.php?id=33377</p>
</body>
</html>
