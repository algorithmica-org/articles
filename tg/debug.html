<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Как дебажить программу - Tinkoff Generation</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="../pandoc.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfjBggQFxAS4ilBAAACgElEQVRIx52VS0iUYRSGn/8fzbxMIYoRKSZKi2wGwo2FxRQZIlGbaGUF0b52LWbTLlx0W7VyEZiBWkE5mraRRrJFRUwolQw6zQTeuoiU423eFuk0M//nhJ7dd+Z7n/8932HOscgIgU0lR/Cxn3LKgGlijDJIkAgJiywhZMujVo0qrsyIa1St8shWFnmp/IooW0TkV6mMYuRVQCv6X6woIK+QQ16vkPP2M/WZICHVpyGEvCb5vE7olH6bEV6l1R4w3RpQkYoVNJcSWHsLIUt+rTpvLOuSELqihAmwKr8sgZBHE2aX5UKoRmNmDxPyCBtoodLU1m5yaADC9Jr7XkkLoCqNmPAx1eqqnqhAqEHfzB5GVGXTQLUJ/5xZznGcOuAtQbOHahpsfOQ5f5mng8McZAdnsVigkyUTIA8fGjZ561OpuiRJY6oR2qU35iKGbSqc4GU6qObYmstmYIrH5iIq0JIT+17lupU8BVUsVKsvJgdLtgnbxXZOJ091HAU+0W+0YCnGnvRUlCa+42OdbRHiA3CSbtyZ+q85RDMBfcxxjZKUf5uPO4wwzGsaMwFR1JZe1Jx8uuB4mBtC6LJzXLTZDLKYihziM+fJzfjQGfYC/XxMTy8yaDNEOLWBDznAIcdT7aMRiPI0PR1myGacnn+Zd7ygiUIHwEUjuUAnsdR0D+M20E7k7/knt5ki39guN9uAEPeIr6citIPrOsxQiC9hveIuLylkkgXyKUsR/2CAB8yyEzdhJiliN3aCmzwCCwSl3FfzDL9wYZFAuClJAcSZJoELALFKAWVYvVxkdm3NbDRUs0TqUM021jeU15s2w9YXSxKy9dWWRGx6uVpOyObW+x/B+LEV0hF3cAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNi0wOFQxNjoyMzoxNiswMjowMLEfSBUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDYtMDhUMTY6MjM6MTYrMDI6MDDAQvCpAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />

  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
     (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
     m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
     (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

     ym(53961409, "init", {
          clickmap:true,
          trackLinks:true,
          accurateTrackBounce:true,
          webvisor:true
     });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53961409" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->

  <script>
  // index page width
  document.addEventListener("DOMContentLoaded", function(event) {
    document.getElementsByClassName('contents')[0].parentElement.style.width = "860px";
    document.getElementsByTagName('h1')[0].style.marginRight = "40px";
  });
  </script>
</head>
<body>
<div id='header'>
    <a href='https://algorithmica.org/tg/'><div id='logo'>Tinkoff Generation</div></a>
    <div id='links'>
        <a href='https://github.com/algorithmica-org/tg/edit/master/debug.md'>Редактировать</a>
        <a href='https://github.com/algorithmica-org/tg/commits/master/debug.md'>История</a>
    </div>
</div>
<div class="migration"><a href='https://ru.algorithmica.org/cs/'>Сайт переезжает.</a> Большинство статей уже перенесено на новую версию.<br>Скоро добавим автоматические переходы, но пока обновленную версию этой статьи можно найти там.</div>
<h1 id="как-дебажить-программу">Как дебажить программу</h1>
<h2 id="введение">Введение</h2>
<p>Обычный алгоритм решения задачи выглядит так:</p>
<ol type="1">
<li><p>Придумать решение.</p></li>
<li><p>Написать код решения (или лучше части решения).</p></li>
<li><p>Тестировать решение на своем компьютере (или лучше потестировать часть решения)</p></li>
</ol>
<p>3+) Если не работает, то дебажить, пока не заработает на всех тестах.</p>
<ol start="4" type="1">
<li>Потестировать в тестирующей системе</li>
</ol>
<p>4+) Если не работает, то придумывать тест, на котором не работает на своем компьютере. Если не находится - напишите стресс-тестирование</p>
<p>4++) Если все работает - внимательно читать код, добавить проверки в опасные места, перечитывать условие задачи, пока не найдете место, где либо вы не поняли задачу, либо ваша программа работает по-разному у вас и на сервере</p>
<p>4+++) Спросить преподавателя. Впрочем, этим методом можно и нужно пользоваться на более ранних стадиях, если вы только начинаете заниматься программированием</p>
<p>Здесь будут собраны советы о том, что делать в пунктах, начиная с 2.</p>
<p>Про первый пункт советов не будет :( Разве что совет, что придумать решение необходимо ДО того, как писать код.</p>
<h2 id="что-делать-пока-пишешь-код">Что делать, пока пишешь код</h2>
<h3 id="проследите-путь-каждой-переменной-и-каждого-цикла">Проследите путь каждой переменной и каждого цикла</h3>
<p>Нужно для каждой переменной понимать * чему она равна изначально * как она меняется в какой части программы * какие значения она может понимать, а какие нет.</p>
<p>Также и для каждого цикла нужно понимать * какая будет первая итерация * в какой момент он закончится * сколько всего будет итераций * нет ли где-то выхода за границы массива</p>
<h3 id="пишите-по-кодстайлу">Пишите по кодстайлу</h3>
<ul>
<li>ставьте отступы</li>
<li>ставьте пробелы вокруг арифметических знаков</li>
<li>пишите понятные, и главное, мало похожие друг на друга названия переменных</li>
<li>делите программу на логические части (про это подробнее следующий совет)</li>
<li>Изучите подробности общепринятого кодстайл: <strong>TODO:</strong> ВСТАВИТЬ ССЫЛКУ НА КАКОЙ-НИБУДЬ КОДСТАЙЛ</li>
</ul>
<p>Зачем? * увидеть ошибку в структурированном коде гораздо проще, чем в каше * чужому человеку и вам в будущем читать ваш непонятный код будет гораздо сложнее и неприятнее * в промышленном программировании именно так все и пишут, полезно привыкнуть</p>
<h3 id="делите-код-на-функции-как-можно-более-сильно">Делите код на функции как можно более сильно</h3>
<p>Почему? * в длинном сплошном коде легко не заметить ошибку * отдельные функции очень просто тестировать * если функция применяется несколько раз, то не нужно копировать код, что хорошо, так как при копировании кода можно скопировать ошибку, увидеть ее, исправить в одном месте, а в другом она * в промышленном программировании именно так все и пишут, полезно привыкнуть</p>
<p>Вот пример, когда в программе без функций найти ошибку тяжело: (код Сережи Карпышева)</p>
<pre><code># Задача - найти точку пересечения двух прямых

#include &lt;iostream&gt;
#include &lt;cmath&gt;
using namespace std;

int main(){
    long long x1, y1, x2, y2;
    cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;
    long long x3, y3, x4, y4;
    cin &gt;&gt; x3 &gt;&gt; y3 &gt;&gt; x4 &gt;&gt; y4;
    if((x1-x2)*(y4-y3)-(y1-y2)*(x4-x3)==0){
        if((x1-x3)*(y2-y3)-(y1-y3)*(x2-x3)==0){
            cout &lt;&lt; 2;
            return 0;
        }
        cout &lt;&lt; 0;
        return 0;
    }
    cout &lt;&lt; 1 &lt;&lt; &#39; &#39;;
    double a1 = y2 - y1;
    double b1 = x1 - x2;
    double c1 = x1*y2-y1*x2;
    double a2 = y4 - y3;
    double b2 = x3 - x4;
    double c2 = x4*y3-y4*x3;
    double x =(b1*c2-b2*c1)/(b2*a1-b1*a2);
    cout &lt;&lt; x &lt;&lt; &#39; &#39;;
    cout &lt;&lt; (c1-c2+a1*x-a2*x)/(b2-b1);

    return 0;
}</code></pre>
<p>Если ты - не Сережа Карпышев в октябре 2017 года, то этот код тебе отдебажить будет очень тяжело. Что здесь можно сделать для увеличения понятности кода: * Структура Point вместо пары чисел x1, y1 * Cчитывание точки происходит 4 раза, удобно сделать для этого функцию или переопределить оператор &gt;&gt; * Вектор разности двух точек считается где-то 6 раз, удобно сделать для этого функцию * Векторное произведение двух векторо считается 6 раз, удобно сделать для этого функцию * Проверку на параллельность двух векторов удобно вынести в отдельную функцию * Координаты прямой a, b, c удобно вынести в отдельную функцию, считающую их по двум точкам * Возможно даже структура Line вместо тройки чисел a, b, c * Координаты пересечения двух прямых удобно считать через функцию от двух прямых, и работать там только с их координатами</p>
<p>Если все это сделать, то код станет понятным, в функции из одной строчки ошибиться очень тяжело. А еще каждую функцию можно легко потестировать отдельно, разобрать крайние случаи для каждой отдельной функции.</p>
<h2 id="как-дебажить-если-знаешь-тест-на-котором-не-работает">Как дебажить, если знаешь тест, на котором не работает</h2>
<p><strong>TODO</strong> описать процесс и виды дебага</p>
<h2 id="самые-частые-ошибки-если-у-вас-все-работает-а-в-тестирующей-системе-нет">Самые частые ошибки, если у вас все работает, а в тестирующей системе нет</h2>
<h3 id="выход-за-границы-массива">Выход за границы массива</h3>
<p>Если у вас ошибка, особенно на C++ - это почти всегда выход за границы массива. Когда вы обращаетесь на C++ к элементу в массиве/векторе, которого не существует, ваша программа по стандарту C++ может сделать все, что угодно (хоть отформатировать диск, но вряд ли такое будет :D). Такая штука называется <strong>undefined behaviour</strong>.</p>
<p>Обычно при запросе к несуществующему элементу массива просто возвращается число из тех битов, которые лежат на том месте в памяти. У вас на компьютере там может быть 0, а на informatics - какое угодно другое число.</p>
<p>Поэтому: * C++ чаще всего не видит эту ошибку и работает дальше. * Ваша программа может работать по-разному у вас и на сервере.</p>
<p>Следите за индексами массивов - это то место, в котором вы должны досконально понимать, какие вы берете индексы и какого размера у вас массив, и всегда это проверять.</p>
<h3 id="слишком-маленький-тип-данных">Слишком маленький тип данных</h3>
<p>Нужно знать, что * int содержит числа примерно от <span class="math inline">\(-2 * 10^9\)</span> до <span class="math inline">\(2 * 10^9\)</span> * unsigned int содержит числа примерно от <span class="math inline">\(0\)</span> до <span class="math inline">\(4 * 10^9\)</span> * long long содержит числа примерно от <span class="math inline">\(-9 * 10^18\)</span> до <span class="math inline">\(9 * 10^18\)</span> * unsigned long long содержит числа примерно от <span class="math inline">\(0\)</span> до <span class="math inline">\(18 * 10^18\)</span></p>
<p>И всегда проверять, что когда вы * складываете * умножаете * вычитаете</p>
<p>числа, они все еще помещаются в выбранный вами тип.</p>
<p>Например, в задаче про быстрое возведение в степень, по условию гарантируется, что <span class="math inline">\(x, N, P \leq 2 * 10^9.\)</span> Это значит, что в тип int они влезут.</p>
<p>НО! В ходе алгоритма вы иногда умножаете два числа. При этом, если вы все делаете правильно, вы работаете всегда только с ОСТАТКАМИ по модулю <span class="math inline">\(P\)</span>, а значит с числами до <span class="math inline">\(2 * 10^9\)</span>. Чтобы ПЕРЕМНОЖИТЬ два таких числа, они должны быть типа long long, иначе произведение двух int-ов будет до <span class="math inline">\(4 * 10^18\)</span>, что в int не влезает, произойдет переполнение. Поэтому в этой задаче обязательно нужно использовать long long, и не забывать брать после каждого действия по модулю.</p>
<h3 id="крайние-случаи">Крайние случаи</h3>
<p>Если вам дана задача и ограчение <span class="math inline">\(0 &lt;= N &lt;= 10^6\)</span>, и вы убедились, что программа работает верно для каких-нибудь <span class="math inline">\(3, 5, 20\)</span>, то это может значить, что программа работает, но не на всех <span class="math inline">\(N\)</span>. Например, для <span class="math inline">\(N = 0\)</span> может быть какой-то отдельный случай, когда решение не работает. То же самое и для <span class="math inline">\(N = 1, 2\)</span>. А для <span class="math inline">\(N = 10^6\)</span> может быть проблема с тем, что она не влезает в память или что-нибудь переполняется (как в пункте 2). Если у вас WA на каком-то тесте, а у вас “на компе все работает”, то начинайте искать тест, на котором и у вас не работает. И в первую очередь смотрите на крайние значения. Если в задаче не одно <span class="math inline">\(N\)</span>, а много сложных входных данных, то придумайте самую стрёмную ситуацию, которую сможете, и проверьте, работает ли ваша программа на ней. Если вам повезет - вы найдете тест, на котором она не работает.</p>
<h3 id="вы-решаете-не-ту-задачу">Вы решаете не ту задачу</h3>
<p>Перечитайте условие, возможно, вы просто праивльно решили не ту задачу, которую надо сдать, а немножко другую. Возможно, вы забыли про какой-то важный случай или принципиально делаете что-то не то.</p>
<h2 id="стресс-тестирование">Стресс-тестирование</h2>
<p>Но если вы достаточно много тестировали свою задачу, то вам может помочь стресс-тестирование</p>
<p><strong>TODO</strong></p>
</body>
</html>
